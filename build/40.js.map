{"version":3,"file":"40.js","mappings":"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","sources":["webpack://rrze-video/./node_modules/vidstack/prod/providers/vidstack-dash.js","webpack://rrze-video/./node_modules/vidstack/prod/providers/vidstack-video.js"],"sourcesContent":["import { loadScript, preconnect } from '../chunks/vidstack-CSpLxgg_.js';\nimport { canPlayVideoType, canPlayAudioType, IS_CHROME, isDASHSupported } from '../chunks/vidstack-C1T0MO0v.js';\nimport { VideoProvider } from './vidstack-video.js';\nimport { listenEvent, effect, DOMEvent, isNumber, isString, camelToKebabCase, isUndefined, isFunction, peek } from '../chunks/vidstack-CRlI3Mh7.js';\nimport { QualitySymbol } from '../chunks/vidstack-B01xzxC4.js';\nimport { TextTrackSymbol, TextTrack } from '../chunks/vidstack-DpjEe5xw.js';\nimport { ListSymbol } from '../chunks/vidstack-D5EzK014.js';\nimport { RAFLoop } from '../chunks/vidstack-DSYpsFWk.js';\nimport { coerceToError } from '../chunks/vidstack-C9vIqaYT.js';\nimport './vidstack-html.js';\nimport '../chunks/vidstack-Dihypf8P.js';\nimport '../chunks/vidstack-CQ0j0noX.js';\nimport '../chunks/vidstack-DE4XvkHU.js';\n\nfunction getLangName(langCode) {\n  try {\n    const displayNames = new Intl.DisplayNames(navigator.languages, { type: \"language\" });\n    const languageName = displayNames.of(langCode);\n    return languageName ?? null;\n  } catch (err) {\n    return null;\n  }\n}\n\nconst toDOMEventType = (type) => `dash-${camelToKebabCase(type)}`;\nclass DASHController {\n  #video;\n  #ctx;\n  #instance = null;\n  #callbacks = /* @__PURE__ */ new Set();\n  #stopLiveSync = null;\n  config = {};\n  get instance() {\n    return this.#instance;\n  }\n  constructor(video, ctx) {\n    this.#video = video;\n    this.#ctx = ctx;\n  }\n  setup(ctor) {\n    this.#instance = ctor().create();\n    const dispatcher = this.#dispatchDASHEvent.bind(this);\n    for (const event of Object.values(ctor.events)) this.#instance.on(event, dispatcher);\n    this.#instance.on(ctor.events.ERROR, this.#onError.bind(this));\n    for (const callback of this.#callbacks) callback(this.#instance);\n    this.#ctx.player.dispatch(\"dash-instance\", {\n      detail: this.#instance\n    });\n    this.#instance.initialize(this.#video, void 0, false);\n    this.#instance.updateSettings({\n      streaming: {\n        text: {\n          // Disabling text rendering by dash.\n          defaultEnabled: false,\n          dispatchForManualRendering: true\n        },\n        buffer: {\n          /// Enables buffer replacement when switching bitrates for faster switching.\n          fastSwitchEnabled: true\n        }\n      },\n      ...this.config\n    });\n    this.#instance.on(ctor.events.FRAGMENT_LOADING_STARTED, this.#onFragmentLoadStart.bind(this));\n    this.#instance.on(\n      ctor.events.FRAGMENT_LOADING_COMPLETED,\n      this.#onFragmentLoadComplete.bind(this)\n    );\n    this.#instance.on(ctor.events.MANIFEST_LOADED, this.#onManifestLoaded.bind(this));\n    this.#instance.on(ctor.events.QUALITY_CHANGE_RENDERED, this.#onQualityChange.bind(this));\n    this.#instance.on(ctor.events.TEXT_TRACKS_ADDED, this.#onTextTracksAdded.bind(this));\n    this.#instance.on(ctor.events.TRACK_CHANGE_RENDERED, this.#onTrackChange.bind(this));\n    this.#ctx.qualities[QualitySymbol.enableAuto] = this.#enableAutoQuality.bind(this);\n    listenEvent(this.#ctx.qualities, \"change\", this.#onUserQualityChange.bind(this));\n    listenEvent(this.#ctx.audioTracks, \"change\", this.#onUserAudioChange.bind(this));\n    this.#stopLiveSync = effect(this.#liveSync.bind(this));\n  }\n  #createDOMEvent(event) {\n    return new DOMEvent(toDOMEventType(event.type), { detail: event });\n  }\n  #liveSync() {\n    if (!this.#ctx.$state.live()) return;\n    const raf = new RAFLoop(this.#liveSyncPosition.bind(this));\n    raf.start();\n    return raf.stop.bind(raf);\n  }\n  #liveSyncPosition() {\n    if (!this.#instance) return;\n    const position = this.#instance.duration() - this.#instance.time();\n    this.#ctx.$state.liveSyncPosition.set(!isNaN(position) ? position : Infinity);\n  }\n  #dispatchDASHEvent(event) {\n    this.#ctx.player?.dispatch(this.#createDOMEvent(event));\n  }\n  #currentTrack = null;\n  #cueTracker = {};\n  #onTextFragmentLoaded(event) {\n    const native = this.#currentTrack?.[TextTrackSymbol.native], cues = (native?.track).cues;\n    if (!native || !cues) return;\n    const id = this.#currentTrack.id, startIndex = this.#cueTracker[id] ?? 0, trigger = this.#createDOMEvent(event);\n    for (let i = startIndex; i < cues.length; i++) {\n      const cue = cues[i];\n      if (!cue.positionAlign) cue.positionAlign = \"auto\";\n      this.#currentTrack.addCue(cue, trigger);\n    }\n    this.#cueTracker[id] = cues.length;\n  }\n  #onTextTracksAdded(event) {\n    if (!this.#instance) return;\n    const data = event.tracks, nativeTextTracks = [...this.#video.textTracks].filter((track) => \"manualMode\" in track), trigger = this.#createDOMEvent(event);\n    for (let i = 0; i < nativeTextTracks.length; i++) {\n      const textTrackInfo = data[i], nativeTextTrack = nativeTextTracks[i];\n      const id = `dash-${textTrackInfo.kind}-${i}`, track = new TextTrack({\n        id,\n        label: textTrackInfo?.label ?? textTrackInfo.labels.find((t) => t.text)?.text ?? (textTrackInfo?.lang && getLangName(textTrackInfo.lang)) ?? textTrackInfo?.lang ?? void 0,\n        language: textTrackInfo.lang ?? void 0,\n        kind: textTrackInfo.kind,\n        default: textTrackInfo.defaultTrack\n      });\n      track[TextTrackSymbol.native] = {\n        managed: true,\n        track: nativeTextTrack\n      };\n      track[TextTrackSymbol.readyState] = 2;\n      track[TextTrackSymbol.onModeChange] = () => {\n        if (!this.#instance) return;\n        if (track.mode === \"showing\") {\n          this.#instance.setTextTrack(i);\n          this.#currentTrack = track;\n        } else {\n          this.#instance.setTextTrack(-1);\n          this.#currentTrack = null;\n        }\n      };\n      this.#ctx.textTracks.add(track, trigger);\n    }\n  }\n  #onTrackChange(event) {\n    const { mediaType, newMediaInfo } = event;\n    if (mediaType === \"audio\") {\n      const track = this.#ctx.audioTracks.getById(`dash-audio-${newMediaInfo.index}`);\n      if (track) {\n        const trigger = this.#createDOMEvent(event);\n        this.#ctx.audioTracks[ListSymbol.select](track, true, trigger);\n      }\n    }\n  }\n  #onQualityChange(event) {\n    if (event.mediaType !== \"video\") return;\n    const quality = this.#ctx.qualities[event.newQuality];\n    if (quality) {\n      const trigger = this.#createDOMEvent(event);\n      this.#ctx.qualities[ListSymbol.select](quality, true, trigger);\n    }\n  }\n  #onManifestLoaded(event) {\n    if (this.#ctx.$state.canPlay() || !this.#instance) return;\n    const { type, mediaPresentationDuration } = event.data, trigger = this.#createDOMEvent(event);\n    this.#ctx.notify(\"stream-type-change\", type !== \"static\" ? \"live\" : \"on-demand\", trigger);\n    this.#ctx.notify(\"duration-change\", mediaPresentationDuration, trigger);\n    this.#ctx.qualities[QualitySymbol.setAuto](true, trigger);\n    const media = this.#instance.getVideoElement();\n    const videoQualities = this.#instance.getTracksForTypeFromManifest(\n      \"video\",\n      event.data\n    );\n    const supportedVideoMimeType = [...new Set(videoQualities.map((e) => e.mimeType))].find(\n      (type2) => type2 && canPlayVideoType(media, type2)\n    );\n    const videoQuality = videoQualities.filter(\n      (track) => supportedVideoMimeType === track.mimeType\n    )[0];\n    let audioTracks = this.#instance.getTracksForTypeFromManifest(\n      \"audio\",\n      event.data\n    );\n    const supportedAudioMimeType = [...new Set(audioTracks.map((e) => e.mimeType))].find(\n      (type2) => type2 && canPlayAudioType(media, type2)\n    );\n    audioTracks = audioTracks.filter((track) => supportedAudioMimeType === track.mimeType);\n    videoQuality.bitrateList.forEach((bitrate, index) => {\n      const quality = {\n        id: bitrate.id?.toString() ?? `dash-bitrate-${index}`,\n        width: bitrate.width ?? 0,\n        height: bitrate.height ?? 0,\n        bitrate: bitrate.bandwidth ?? 0,\n        codec: videoQuality.codec,\n        index\n      };\n      this.#ctx.qualities[ListSymbol.add](quality, trigger);\n    });\n    if (isNumber(videoQuality.index)) {\n      const quality = this.#ctx.qualities[videoQuality.index];\n      if (quality) this.#ctx.qualities[ListSymbol.select](quality, true, trigger);\n    }\n    audioTracks.forEach((audioTrack, index) => {\n      const matchingLabel = audioTrack.labels.find((label2) => {\n        return navigator.languages.some((language) => {\n          return label2.lang && language.toLowerCase().startsWith(label2.lang.toLowerCase());\n        });\n      });\n      const label = matchingLabel || audioTrack.labels[0];\n      const localTrack = {\n        id: `dash-audio-${audioTrack?.index}`,\n        label: label?.text ?? (audioTrack.lang && getLangName(audioTrack.lang)) ?? audioTrack.lang ?? \"\",\n        language: audioTrack.lang ?? \"\",\n        kind: \"main\",\n        mimeType: audioTrack.mimeType,\n        codec: audioTrack.codec,\n        index\n      };\n      this.#ctx.audioTracks[ListSymbol.add](localTrack, trigger);\n    });\n    media.dispatchEvent(new DOMEvent(\"canplay\", { trigger }));\n  }\n  #onError(event) {\n    const { type: eventType, error: data } = event;\n    switch (data.code) {\n      case 27:\n        this.#onNetworkError(data);\n        break;\n      default:\n        this.#onFatalError(data);\n        break;\n    }\n  }\n  #onFragmentLoadStart() {\n    if (this.#retryLoadingTimer >= 0) this.#clearRetryTimer();\n  }\n  #onFragmentLoadComplete(event) {\n    const mediaType = event.mediaType;\n    if (mediaType === \"text\") {\n      requestAnimationFrame(this.#onTextFragmentLoaded.bind(this, event));\n    }\n  }\n  #retryLoadingTimer = -1;\n  #onNetworkError(error) {\n    this.#clearRetryTimer();\n    this.#instance?.play();\n    this.#retryLoadingTimer = window.setTimeout(() => {\n      this.#retryLoadingTimer = -1;\n      this.#onFatalError(error);\n    }, 5e3);\n  }\n  #clearRetryTimer() {\n    clearTimeout(this.#retryLoadingTimer);\n    this.#retryLoadingTimer = -1;\n  }\n  #onFatalError(error) {\n    this.#ctx.notify(\"error\", {\n      message: error.message ?? \"\",\n      code: 1,\n      error\n    });\n  }\n  #enableAutoQuality() {\n    this.#switchAutoBitrate(\"video\", true);\n    const { qualities } = this.#ctx;\n    this.#instance?.setQualityFor(\"video\", qualities.selectedIndex, true);\n  }\n  #switchAutoBitrate(type, auto) {\n    this.#instance?.updateSettings({\n      streaming: { abr: { autoSwitchBitrate: { [type]: auto } } }\n    });\n  }\n  #onUserQualityChange() {\n    const { qualities } = this.#ctx;\n    if (!this.#instance || qualities.auto || !qualities.selected) return;\n    this.#switchAutoBitrate(\"video\", false);\n    this.#instance.setQualityFor(\"video\", qualities.selectedIndex, qualities.switch === \"current\");\n    if (IS_CHROME) {\n      this.#video.currentTime = this.#video.currentTime;\n    }\n  }\n  #onUserAudioChange() {\n    if (!this.#instance) return;\n    const { audioTracks } = this.#ctx, selectedTrack = this.#instance.getTracksFor(\"audio\").find(\n      (track) => audioTracks.selected && audioTracks.selected.id === `dash-audio-${track.index}`\n    );\n    if (selectedTrack) this.#instance.setCurrentTrack(selectedTrack);\n  }\n  #reset() {\n    this.#clearRetryTimer();\n    this.#currentTrack = null;\n    this.#cueTracker = {};\n  }\n  onInstance(callback) {\n    this.#callbacks.add(callback);\n    return () => this.#callbacks.delete(callback);\n  }\n  loadSource(src) {\n    this.#reset();\n    if (!isString(src.src)) return;\n    this.#instance?.attachSource(src.src);\n  }\n  destroy() {\n    this.#reset();\n    this.#instance?.destroy();\n    this.#instance = null;\n    this.#stopLiveSync?.();\n    this.#stopLiveSync = null;\n  }\n}\n\nclass DASHLibLoader {\n  #lib;\n  #ctx;\n  #callback;\n  constructor(lib, ctx, callback) {\n    this.#lib = lib;\n    this.#ctx = ctx;\n    this.#callback = callback;\n    this.#startLoading();\n  }\n  async #startLoading() {\n    const callbacks = {\n      onLoadStart: this.#onLoadStart.bind(this),\n      onLoaded: this.#onLoaded.bind(this),\n      onLoadError: this.#onLoadError.bind(this)\n    };\n    let ctor = await loadDASHScript(this.#lib, callbacks);\n    if (isUndefined(ctor) && !isString(this.#lib)) ctor = await importDASH(this.#lib, callbacks);\n    if (!ctor) return null;\n    if (!window.dashjs.supportsMediaSource()) {\n      const message = \"[vidstack] `dash.js` is not supported in this environment\";\n      this.#ctx.player.dispatch(new DOMEvent(\"dash-unsupported\"));\n      this.#ctx.notify(\"error\", { message, code: 4 });\n      return null;\n    }\n    return ctor;\n  }\n  #onLoadStart() {\n    this.#ctx.player.dispatch(new DOMEvent(\"dash-lib-load-start\"));\n  }\n  #onLoaded(ctor) {\n    this.#ctx.player.dispatch(\n      new DOMEvent(\"dash-lib-loaded\", {\n        detail: ctor\n      })\n    );\n    this.#callback(ctor);\n  }\n  #onLoadError(e) {\n    const error = coerceToError(e);\n    this.#ctx.player.dispatch(\n      new DOMEvent(\"dash-lib-load-error\", {\n        detail: error\n      })\n    );\n    this.#ctx.notify(\"error\", {\n      message: error.message,\n      code: 4,\n      error\n    });\n  }\n}\nasync function importDASH(loader, callbacks = {}) {\n  if (isUndefined(loader)) return void 0;\n  callbacks.onLoadStart?.();\n  if (isDASHConstructor(loader)) {\n    callbacks.onLoaded?.(loader);\n    return loader;\n  }\n  if (isDASHNamespace(loader)) {\n    const ctor = loader.MediaPlayer;\n    callbacks.onLoaded?.(ctor);\n    return ctor;\n  }\n  try {\n    const ctor = (await loader())?.default;\n    if (isDASHNamespace(ctor)) {\n      callbacks.onLoaded?.(ctor.MediaPlayer);\n      return ctor.MediaPlayer;\n    }\n    if (ctor) {\n      callbacks.onLoaded?.(ctor);\n    } else {\n      throw Error(\n        false ? \"[vidstack] failed importing `dash.js`. Dynamic import returned invalid object.\" : \"\"\n      );\n    }\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nasync function loadDASHScript(src, callbacks = {}) {\n  if (!isString(src)) return void 0;\n  callbacks.onLoadStart?.();\n  try {\n    await loadScript(src);\n    if (!isFunction(window.dashjs.MediaPlayer)) {\n      throw Error(\n        false ? \"[vidstack] failed loading `dash.js`. Could not find a valid `Dash` constructor on window\" : \"\"\n      );\n    }\n    const ctor = window.dashjs.MediaPlayer;\n    callbacks.onLoaded?.(ctor);\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nfunction isDASHConstructor(value) {\n  return value && value.prototype && value.prototype !== Function;\n}\nfunction isDASHNamespace(value) {\n  return value && \"MediaPlayer\" in value;\n}\n\nconst JS_DELIVR_CDN = \"https://cdn.jsdelivr.net\";\nclass DASHProvider extends VideoProvider {\n  $$PROVIDER_TYPE = \"DASH\";\n  #ctor = null;\n  #controller = new DASHController(this.video, this.ctx);\n  /**\n   * The `dash.js` constructor.\n   */\n  get ctor() {\n    return this.#ctor;\n  }\n  /**\n   * The current `dash.js` instance.\n   */\n  get instance() {\n    return this.#controller.instance;\n  }\n  /**\n   * Whether `dash.js` is supported in this environment.\n   */\n  static supported = isDASHSupported();\n  get type() {\n    return \"dash\";\n  }\n  get canLiveSync() {\n    return true;\n  }\n  #library = `${JS_DELIVR_CDN}/npm/dashjs@4.7.4/dist/dash${\".all.min.js\"}`;\n  /**\n   * The `dash.js` configuration object.\n   *\n   * @see {@link https://cdn.dashjs.org/latest/jsdoc/module-Settings.html}\n   */\n  get config() {\n    return this.#controller.config;\n  }\n  set config(config) {\n    this.#controller.config = config;\n  }\n  /**\n   * The `dash.js` constructor (supports dynamic imports) or a URL of where it can be found.\n   *\n   * @defaultValue `https://cdn.jsdelivr.net/npm/dashjs@4.7.4/dist/dash.all.min.js`\n   */\n  get library() {\n    return this.#library;\n  }\n  set library(library) {\n    this.#library = library;\n  }\n  preconnect() {\n    if (!isString(this.#library)) return;\n    preconnect(this.#library);\n  }\n  setup() {\n    super.setup();\n    new DASHLibLoader(this.#library, this.ctx, (ctor) => {\n      this.#ctor = ctor;\n      this.#controller.setup(ctor);\n      this.ctx.notify(\"provider-setup\", this);\n      const src = peek(this.ctx.$state.source);\n      if (src) this.loadSource(src);\n    });\n  }\n  async loadSource(src, preload) {\n    if (!isString(src.src)) {\n      this.removeSource();\n      return;\n    }\n    this.media.preload = preload || \"\";\n    this.appendSource(src, \"application/x-mpegurl\");\n    this.#controller.loadSource(src);\n    this.currentSrc = src;\n  }\n  /**\n   * The given callback is invoked when a new `dash.js` instance is created and right before it's\n   * attached to media.\n   */\n  onInstance(callback) {\n    const instance = this.#controller.instance;\n    if (instance) callback(instance);\n    return this.#controller.onInstance(callback);\n  }\n  destroy() {\n    this.#controller.destroy();\n  }\n}\n\nexport { DASHProvider };\n","import { onDispose, EventsController, listenEvent, DOMEvent, scoped } from '../chunks/vidstack-CRlI3Mh7.js';\nimport { canUsePictureInPicture, canUseVideoPresentation, canPlayHLSNatively } from '../chunks/vidstack-C1T0MO0v.js';\nimport { HTMLMediaProvider } from './vidstack-html.js';\nimport { HTMLAirPlayAdapter } from '../chunks/vidstack-CQ0j0noX.js';\nimport { TextTrack, TextTrackSymbol } from '../chunks/vidstack-DpjEe5xw.js';\nimport '../chunks/vidstack-DSYpsFWk.js';\nimport '../chunks/vidstack-Dihypf8P.js';\nimport '../chunks/vidstack-D5EzK014.js';\nimport '../chunks/vidstack-CSpLxgg_.js';\nimport '../chunks/vidstack-DE4XvkHU.js';\n\nclass NativeHLSTextTracks {\n  #video;\n  #ctx;\n  constructor(video, ctx) {\n    this.#video = video;\n    this.#ctx = ctx;\n    video.textTracks.onaddtrack = this.#onAddTrack.bind(this);\n    onDispose(this.#onDispose.bind(this));\n  }\n  #onAddTrack(event) {\n    const nativeTrack = event.track;\n    if (!nativeTrack || findTextTrackElement(this.#video, nativeTrack)) return;\n    const track = new TextTrack({\n      id: nativeTrack.id,\n      kind: nativeTrack.kind,\n      label: nativeTrack.label ?? \"\",\n      language: nativeTrack.language,\n      type: \"vtt\"\n    });\n    track[TextTrackSymbol.native] = { track: nativeTrack };\n    track[TextTrackSymbol.readyState] = 2;\n    track[TextTrackSymbol.nativeHLS] = true;\n    let lastIndex = 0;\n    const onCueChange = (event2) => {\n      if (!nativeTrack.cues) return;\n      for (let i = lastIndex; i < nativeTrack.cues.length; i++) {\n        track.addCue(nativeTrack.cues[i], event2);\n        lastIndex++;\n      }\n    };\n    onCueChange(event);\n    nativeTrack.oncuechange = onCueChange;\n    this.#ctx.textTracks.add(track, event);\n    track.setMode(nativeTrack.mode, event);\n  }\n  #onDispose() {\n    this.#video.textTracks.onaddtrack = null;\n    for (const track of this.#ctx.textTracks) {\n      const nativeTrack = track[TextTrackSymbol.native]?.track;\n      if (nativeTrack?.oncuechange) nativeTrack.oncuechange = null;\n    }\n  }\n}\nfunction findTextTrackElement(video, track) {\n  return Array.from(video.children).find((el) => el.track === track);\n}\n\nclass VideoPictureInPicture {\n  #video;\n  #media;\n  constructor(video, media) {\n    this.#video = video;\n    this.#media = media;\n    new EventsController(video).add(\"enterpictureinpicture\", this.#onEnter.bind(this)).add(\"leavepictureinpicture\", this.#onExit.bind(this));\n  }\n  get active() {\n    return document.pictureInPictureElement === this.#video;\n  }\n  get supported() {\n    return canUsePictureInPicture(this.#video);\n  }\n  async enter() {\n    return this.#video.requestPictureInPicture();\n  }\n  exit() {\n    return document.exitPictureInPicture();\n  }\n  #onEnter(event) {\n    this.#onChange(true, event);\n  }\n  #onExit(event) {\n    this.#onChange(false, event);\n  }\n  #onChange = (active, event) => {\n    this.#media.notify(\"picture-in-picture-change\", active, event);\n  };\n}\n\nclass VideoPresentation {\n  #video;\n  #media;\n  #mode = \"inline\";\n  get mode() {\n    return this.#mode;\n  }\n  constructor(video, media) {\n    this.#video = video;\n    this.#media = media;\n    listenEvent(video, \"webkitpresentationmodechanged\", this.#onModeChange.bind(this));\n  }\n  get supported() {\n    return canUseVideoPresentation(this.#video);\n  }\n  async setPresentationMode(mode) {\n    if (this.#mode === mode) return;\n    this.#video.webkitSetPresentationMode(mode);\n  }\n  #onModeChange(event) {\n    const prevMode = this.#mode;\n    this.#mode = this.#video.webkitPresentationMode;\n    this.#media.player?.dispatch(\n      new DOMEvent(\"video-presentation-change\", {\n        detail: this.#mode,\n        trigger: event\n      })\n    );\n    [\"fullscreen\", \"picture-in-picture\"].forEach((type) => {\n      if (this.#mode === type || prevMode === type) {\n        this.#media.notify(`${type}-change`, this.#mode === type, event);\n      }\n    });\n  }\n}\nclass FullscreenPresentationAdapter {\n  #presentation;\n  get active() {\n    return this.#presentation.mode === \"fullscreen\";\n  }\n  get supported() {\n    return this.#presentation.supported;\n  }\n  constructor(presentation) {\n    this.#presentation = presentation;\n  }\n  async enter() {\n    this.#presentation.setPresentationMode(\"fullscreen\");\n  }\n  async exit() {\n    this.#presentation.setPresentationMode(\"inline\");\n  }\n}\nclass PIPPresentationAdapter {\n  #presentation;\n  get active() {\n    return this.#presentation.mode === \"picture-in-picture\";\n  }\n  get supported() {\n    return this.#presentation.supported;\n  }\n  constructor(presentation) {\n    this.#presentation = presentation;\n  }\n  async enter() {\n    this.#presentation.setPresentationMode(\"picture-in-picture\");\n  }\n  async exit() {\n    this.#presentation.setPresentationMode(\"inline\");\n  }\n}\n\nclass VideoProvider extends HTMLMediaProvider {\n  $$PROVIDER_TYPE = \"VIDEO\";\n  get type() {\n    return \"video\";\n  }\n  airPlay;\n  fullscreen;\n  pictureInPicture;\n  constructor(video, ctx) {\n    super(video, ctx);\n    scoped(() => {\n      this.airPlay = new HTMLAirPlayAdapter(video, ctx);\n      if (canUseVideoPresentation(video)) {\n        const presentation = new VideoPresentation(video, ctx);\n        this.fullscreen = new FullscreenPresentationAdapter(presentation);\n        this.pictureInPicture = new PIPPresentationAdapter(presentation);\n      } else if (canUsePictureInPicture(video)) {\n        this.pictureInPicture = new VideoPictureInPicture(video, ctx);\n      }\n    }, this.scope);\n  }\n  setup() {\n    super.setup();\n    if (canPlayHLSNatively(this.video)) {\n      new NativeHLSTextTracks(this.video, this.ctx);\n    }\n    this.ctx.textRenderers.attachVideo(this.video);\n    onDispose(() => {\n      this.ctx.textRenderers.attachVideo(null);\n    });\n    if (this.type === \"video\") this.ctx.notify(\"provider-setup\", this);\n  }\n  /**\n   * The native HTML `<video>` element.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement}\n   */\n  get video() {\n    return this.media;\n  }\n}\n\nexport { VideoProvider };\n"],"names":["getLangName","langCode","Intl","DisplayNames","navigator","languages","type","of","err","DASHController","Set","config","instance","this","constructor","video","ctx","setup","ctor","create","dispatcher","bind","event","Object","values","events","on","ERROR","callback","player","dispatch","detail","initialize","updateSettings","streaming","text","defaultEnabled","dispatchForManualRendering","buffer","fastSwitchEnabled","FRAGMENT_LOADING_STARTED","FRAGMENT_LOADING_COMPLETED","MANIFEST_LOADED","QUALITY_CHANGE_RENDERED","TEXT_TRACKS_ADDED","TRACK_CHANGE_RENDERED","qualities","enableAuto","audioTracks","$state","live","raf","start","stop","position","duration","time","liveSyncPosition","set","isNaN","Infinity","native","cues","track","id","startIndex","trigger","i","length","cue","positionAlign","addCue","data","tracks","nativeTextTracks","textTracks","filter","textTrackInfo","nativeTextTrack","kind","label","labels","find","t","lang","language","default","defaultTrack","managed","readyState","onModeChange","mode","setTextTrack","add","mediaType","newMediaInfo","getById","index","select","quality","newQuality","canPlay","mediaPresentationDuration","notify","setAuto","media","getVideoElement","videoQualities","getTracksForTypeFromManifest","supportedVideoMimeType","map","e","mimeType","type2","videoQuality","supportedAudioMimeType","bitrateList","forEach","bitrate","toString","width","height","bandwidth","codec","audioTrack","label2","some","toLowerCase","startsWith","localTrack","dispatchEvent","eventType","error","code","requestAnimationFrame","play","window","setTimeout","clearTimeout","message","setQualityFor","selectedIndex","auto","abr","autoSwitchBitrate","selected","switch","currentTime","selectedTrack","getTracksFor","setCurrentTrack","onInstance","delete","loadSource","src","attachSource","destroy","DASHLibLoader","lib","callbacks","onLoadStart","onLoaded","onLoadError","async","dashjs","MediaPlayer","Error","loadDASHScript","loader","value","prototype","Function","isDASHNamespace","importDASH","supportsMediaSource","DASHProvider","VideoProvider","$$PROVIDER_TYPE","static","canLiveSync","library","preconnect","super","source","preload","appendSource","currentSrc","removeSource","NativeHLSTextTracks","onaddtrack","nativeTrack","Array","from","children","el","findTextTrackElement","nativeHLS","lastIndex","onCueChange","event2","oncuechange","setMode","VideoPictureInPicture","active","document","pictureInPictureElement","supported","enter","requestPictureInPicture","exit","exitPictureInPicture","VideoPresentation","setPresentationMode","webkitSetPresentationMode","prevMode","webkitPresentationMode","FullscreenPresentationAdapter","presentation","PIPPresentationAdapter","airPlay","fullscreen","pictureInPicture","scope","textRenderers","attachVideo"],"sourceRoot":""}